(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,43531,e=>{"use strict";let t=(0,e.i(75254).default)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],43531)},74886,e=>{"use strict";let t=(0,e.i(75254).default)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);e.s(["Copy",()=>t],74886)},7233,e=>{"use strict";let t=(0,e.i(75254).default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},57480,e=>{"use strict";var t=e.i(43476),s=e.i(71645),r=e.i(18393),a=e.i(7233),l=e.i(63209),i=e.i(74886),n=e.i(43531);function d(){let[e,r]=(0,s.useState)([]),[i,n]=(0,s.useState)(!0),[d,c]=(0,s.useState)(null),[u,h]=(0,s.useState)(!1);(0,s.useEffect)(()=>{g()},[]);let g=async()=>{try{n(!0);let e=localStorage.getItem("api_key");if(!e)throw Error("No API key");let t=await fetch("/api/v1/endpoints",{headers:{"x-api-key":e}}),s=await t.json();if(!t.ok)throw Error(s.error||"Failed to load");let a=await Promise.all((s.endpoints||[]).map(async t=>{try{let s=await fetch(`/api/v1/endpoints/${t.id}/summary`,{headers:{"x-api-key":e}}),r=await s.json();return{...t,pricePerCall:t.pricePerCall||t.price_per_call||"0.001",platformFeeBps:t.platformFeeBps||t.platform_fee_bps||200,thisMonth:r.thisMonth}}catch{return t}}));r(a)}catch(e){c(e.message)}finally{n(!1)}};return(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"Metered Endpoints"}),(0,t.jsx)("p",{className:"text-gray-400 mt-1",children:"Create endpoints with per-call pricing"})]}),(0,t.jsxs)("button",{onClick:()=>h(!0),className:"flex items-center gap-2 px-4 py-2 bg-lime-400 text-gray-900 rounded-lg font-medium hover:bg-lime-300",children:[(0,t.jsx)(a.Plus,{className:"w-4 h-4"}),"Create Endpoint"]})]}),d&&(0,t.jsxs)("div",{className:"mb-6 p-4 bg-red-900/20 border border-red-800 rounded-lg flex items-center gap-3",children:[(0,t.jsx)(l.AlertCircle,{className:"w-5 h-5 text-red-400"}),(0,t.jsx)("span",{className:"text-red-400",children:d})]}),i?(0,t.jsx)(p,{}):0===e.length?(0,t.jsx)(m,{onCreateClick:()=>h(!0)}):(0,t.jsx)(o,{endpoints:e,onRefresh:g}),u&&(0,t.jsx)(x,{onClose:()=>h(!1),onCreated:()=>{h(!1),g()}})]})}function o({endpoints:e,onRefresh:s}){return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-12 gap-4 px-4 text-sm text-gray-500 font-medium",children:[(0,t.jsx)("div",{className:"col-span-4",children:"Endpoint"}),(0,t.jsx)("div",{className:"col-span-2",children:"Price/Call"}),(0,t.jsx)("div",{className:"col-span-2",children:"Calls (Month)"}),(0,t.jsx)("div",{className:"col-span-2",children:"Revenue"}),(0,t.jsx)("div",{className:"col-span-2",children:"Status"})]}),e.map(e=>(0,t.jsx)(c,{endpoint:e},e.id))]})}function c({endpoint:e}){let[r,a]=(0,s.useState)(!1),l=(parseFloat(e.pricePerCall)*(e.platformFeeBps/1e4)).toFixed(6);return(0,t.jsxs)("div",{className:"grid grid-cols-12 gap-4 p-4 bg-gray-900 rounded-lg border border-gray-800 items-center",children:[(0,t.jsxs)("div",{className:"col-span-4",children:[(0,t.jsx)("div",{className:"font-medium text-white",children:e.name}),(0,t.jsx)("div",{className:"text-sm text-gray-500 truncate",children:e.upstreamUrl}),(0,t.jsxs)("button",{onClick:()=>{let t=`${window.location.origin}/api/v1/run/${e.id}`;navigator.clipboard.writeText(t),a(!0),setTimeout(()=>a(!1),2e3)},className:"mt-1 text-xs text-lime-400 hover:text-lime-300 flex items-center gap-1",children:[r?(0,t.jsx)(n.Check,{className:"w-3 h-3"}):(0,t.jsx)(i.Copy,{className:"w-3 h-3"}),r?"Copied!":"Copy metered URL"]})]}),(0,t.jsxs)("div",{className:"col-span-2",children:[(0,t.jsxs)("div",{className:"text-white font-mono",children:["$",e.pricePerCall]}),(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:["Fee: $",l," (",e.platformFeeBps/100,"%)"]})]}),(0,t.jsx)("div",{className:"col-span-2",children:(0,t.jsx)("div",{className:"text-white font-mono",children:e.thisMonth?.calls?.toLocaleString()||"0"})}),(0,t.jsxs)("div",{className:"col-span-2",children:[(0,t.jsxs)("div",{className:"text-lime-400 font-mono",children:["$",e.thisMonth?.creatorNet||"0.00"]}),(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:["Gross: $",e.thisMonth?.gross||"0.00"]})]}),(0,t.jsx)("div",{className:"col-span-2",children:(0,t.jsx)("span",{className:`px-2 py-1 text-xs rounded ${"active"===e.status?"bg-green-900/30 text-green-400":"bg-gray-800 text-gray-400"}`,children:e.status})})]})}function m({onCreateClick:e}){return(0,t.jsxs)("div",{className:"text-center py-16 bg-gray-900 rounded-lg border border-gray-800",children:[(0,t.jsx)(r.Server,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"No metered endpoints yet"}),(0,t.jsx)("p",{className:"text-gray-400 mb-6 max-w-md mx-auto",children:"Create a metered endpoint to start charging per API call. Set your price, and we'll handle the billing."}),(0,t.jsx)("button",{onClick:e,className:"px-6 py-3 bg-lime-400 text-gray-900 rounded-lg font-medium hover:bg-lime-300",children:"Create Your First Endpoint"})]})}function p(){return(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-lime-400"}),(0,t.jsx)("p",{className:"mt-4 text-gray-400",children:"Loading endpoints..."})]})}function x({onClose:e,onCreated:r}){let[a,l]=(0,s.useState)(!1),[i,n]=(0,s.useState)(null),[d,o]=(0,s.useState)({name:"",upstreamUrl:"",pricePerCall:"0.001",platformFeeBps:200,recipientAddress:""}),c=async e=>{e.preventDefault(),l(!0),n(null);try{let e=localStorage.getItem("api_key");if(!e)throw Error("No API key");let t=await fetch("/api/v1/endpoints",{method:"POST",headers:{"Content-Type":"application/json","x-api-key":e},body:JSON.stringify({name:d.name,upstreamUrl:d.upstreamUrl,price:"1000000",recipientAddress:d.recipientAddress,pricePerCall:d.pricePerCall,platformFeeBps:d.platformFeeBps})}),s=await t.json();if(!t.ok)throw Error(s.error||"Failed to create endpoint");r()}catch(e){n(e.message)}finally{l(!1)}};return(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,t.jsxs)("div",{className:"bg-gray-900 rounded-xl border border-gray-800 p-6 max-w-lg w-full mx-4",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold mb-6",children:"Create Metered Endpoint"}),i&&(0,t.jsx)("div",{className:"mb-4 p-3 bg-red-900/20 border border-red-800 rounded-lg text-red-400 text-sm",children:i}),(0,t.jsxs)("form",{onSubmit:c,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Endpoint Name *"}),(0,t.jsx)("input",{type:"text",required:!0,value:d.name,onChange:e=>o({...d,name:e.target.value}),placeholder:"My API Endpoint",className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-lime-400 focus:outline-none"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Upstream URL *"}),(0,t.jsx)("input",{type:"url",required:!0,value:d.upstreamUrl,onChange:e=>o({...d,upstreamUrl:e.target.value}),placeholder:"https://api.example.com/v1/endpoint",className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-lime-400 focus:outline-none"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"The actual API endpoint that will be called"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Price per Call (USDC) *"}),(0,t.jsx)("input",{type:"text",required:!0,value:d.pricePerCall,onChange:e=>o({...d,pricePerCall:e.target.value}),placeholder:"0.001",className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-lime-400 focus:outline-none"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Platform Fee (%)"}),(0,t.jsx)("input",{type:"number",min:"0",max:"100",step:"0.1",value:d.platformFeeBps/100,onChange:e=>o({...d,platformFeeBps:100*parseFloat(e.target.value)}),className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white focus:border-lime-400 focus:outline-none"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Your Wallet Address *"}),(0,t.jsx)("input",{type:"text",required:!0,value:d.recipientAddress,onChange:e=>o({...d,recipientAddress:e.target.value}),placeholder:"0x...",className:"w-full px-4 py-2 bg-gray-800 border border-gray-700 rounded-lg text-white font-mono text-sm focus:border-lime-400 focus:outline-none"}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Where you'll receive payments (minus platform fee)"})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,t.jsx)("button",{type:"submit",disabled:a,className:"flex-1 px-4 py-2 bg-lime-400 text-gray-900 rounded-lg font-medium hover:bg-lime-300 disabled:opacity-50",children:a?"Creating...":"Create Endpoint"}),(0,t.jsx)("button",{type:"button",onClick:e,className:"flex-1 px-4 py-2 bg-gray-800 text-gray-300 rounded-lg hover:bg-gray-700",children:"Cancel"})]})]})]})})}e.s(["default",()=>d])}]);