(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,32355,e=>{"use strict";var s=e.i(43476),t=e.i(71645);function a(){let[e,a]=(0,t.useState)([]),[l,r]=(0,t.useState)([]),[d,c]=(0,t.useState)(!0),[i,n]=(0,t.useState)(null);async function o(){try{c(!0);let e=await fetch("/api/security/events",{headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")||""}`}});if(!e.ok)throw Error(`Failed to load security events: ${e.status}`);let s=await e.json();a(s.threatHistory||[]),r(s.blockedIps||[]),n(null)}catch(e){n(e instanceof Error?e.message:"Failed to load security events")}finally{c(!1)}}(0,t.useEffect)(()=>{o();let e=setInterval(o,3e4);return()=>clearInterval(e)},[]);let m={critical:"bg-red-600",high:"bg-orange-600",medium:"bg-yellow-600",low:"bg-blue-600"};return(0,s.jsx)("div",{className:"min-h-screen bg-gray-900 text-white p-8",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"Security Dashboard"}),i&&(0,s.jsx)("div",{className:"bg-red-900/50 border border-red-600 rounded-lg p-4 mb-6",children:(0,s.jsxs)("p",{className:"text-red-200",children:["Error: ",i]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Blocked IPs"}),(0,s.jsx)("p",{className:"text-3xl font-bold text-red-400",children:l.length})]}),(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Threat Sources"}),(0,s.jsx)("p",{className:"text-3xl font-bold text-orange-400",children:e.length})]}),(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Total Threats"}),(0,s.jsx)("p",{className:"text-3xl font-bold text-yellow-400",children:e.reduce((e,s)=>e+s.threatCount,0)})]})]}),l.length>0&&(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 mb-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Blocked IP Addresses"}),(0,s.jsx)("div",{className:"space-y-2",children:l.map(e=>(0,s.jsx)("div",{className:"bg-red-900/30 border border-red-600 rounded p-3",children:(0,s.jsx)("code",{className:"text-red-300",children:e})},e))})]}),(0,s.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Threat History"}),d?(0,s.jsx)("p",{className:"text-gray-400",children:"Loading..."}):0===e.length?(0,s.jsx)("p",{className:"text-gray-400",children:"No security threats detected"}):(0,s.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,s.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("code",{className:"text-lg font-mono text-blue-300",children:e.ip}),(0,s.jsxs)("span",{className:"ml-4 text-sm text-gray-400",children:[e.threatCount," threat(s)"]})]}),(0,s.jsxs)("div",{className:"text-sm text-gray-400",children:["Last seen: ",new Date(e.lastSeen).toLocaleString()]})]}),(0,s.jsx)("div",{className:"mt-3 space-y-2",children:e.recentEvents.map((e,t)=>(0,s.jsxs)("div",{className:`p-2 rounded ${m[e.severity]||"bg-gray-600"}`,children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("span",{className:"font-semibold",children:e.category}),(0,s.jsx)("span",{className:"ml-2 text-sm opacity-75",children:e.type})]}),(0,s.jsx)("span",{className:"text-xs uppercase",children:e.severity})]}),(0,s.jsx)("p",{className:"text-sm mt-1",children:e.description}),(0,s.jsx)("p",{className:"text-xs mt-1 opacity-75",children:new Date(e.timestamp).toLocaleString()})]},t))})]},e.ip))})]})]})})}e.s(["default",()=>a])}]);