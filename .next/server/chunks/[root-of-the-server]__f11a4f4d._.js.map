{"version":3,"sources":["turbopack:///[project]/node_modules/thread-stream/package.json","../../../node_modules/viem/chains/definitions/base.ts","../../../node_modules/viem/op-stack/chainConfig.ts","../../../node_modules/viem/op-stack/serializers.ts","../../../node_modules/viem/op-stack/formatters.ts","../../../node_modules/viem/op-stack/contracts.ts"],"sourcesContent":["{\"name\":\"thread-stream\",\"version\":\"3.1.0\",\"description\":\"A streaming way to send data to a Node.js Worker Thread\",\"main\":\"index.js\",\"types\":\"index.d.ts\",\"dependencies\":{\"real-require\":\"^0.2.0\"},\"devDependencies\":{\"@types/node\":\"^20.1.0\",\"@types/tap\":\"^15.0.0\",\"@yao-pkg/pkg\":\"^5.11.5\",\"desm\":\"^1.3.0\",\"fastbench\":\"^1.0.1\",\"husky\":\"^9.0.6\",\"pino-elasticsearch\":\"^8.0.0\",\"sonic-boom\":\"^4.0.1\",\"standard\":\"^17.0.0\",\"tap\":\"^16.2.0\",\"ts-node\":\"^10.8.0\",\"typescript\":\"^5.3.2\",\"why-is-node-running\":\"^2.2.2\"},\"scripts\":{\"build\":\"tsc --noEmit\",\"test\":\"standard && npm run build && npm run transpile && tap \\\"test/**/*.test.*js\\\" && tap --ts test/*.test.*ts\",\"test:ci\":\"standard && npm run transpile && npm run test:ci:js && npm run test:ci:ts\",\"test:ci:js\":\"tap --no-check-coverage --timeout=120 --coverage-report=lcovonly \\\"test/**/*.test.*js\\\"\",\"test:ci:ts\":\"tap --ts --no-check-coverage --coverage-report=lcovonly \\\"test/**/*.test.*ts\\\"\",\"test:yarn\":\"npm run transpile && tap \\\"test/**/*.test.js\\\" --no-check-coverage\",\"transpile\":\"sh ./test/ts/transpile.sh\",\"prepare\":\"husky install\"},\"standard\":{\"ignore\":[\"test/ts/**/*\",\"test/syntax-error.mjs\"]},\"repository\":{\"type\":\"git\",\"url\":\"git+https://github.com/mcollina/thread-stream.git\"},\"keywords\":[\"worker\",\"thread\",\"threads\",\"stream\"],\"author\":\"Matteo Collina <hello@matteocollina.com>\",\"license\":\"MIT\",\"bugs\":{\"url\":\"https://github.com/mcollina/thread-stream/issues\"},\"homepage\":\"https://github.com/mcollina/thread-stream#readme\"}","import { chainConfig } from '../../op-stack/chainConfig.js'\nimport { defineChain } from '../../utils/chain/defineChain.js'\n\nconst sourceId = 1 // mainnet\n\nexport const base = /*#__PURE__*/ defineChain({\n  ...chainConfig,\n  id: 8453,\n  name: 'Base',\n  nativeCurrency: { name: 'Ether', symbol: 'ETH', decimals: 18 },\n  rpcUrls: {\n    default: {\n      http: ['https://mainnet.base.org'],\n    },\n  },\n  blockExplorers: {\n    default: {\n      name: 'Basescan',\n      url: 'https://basescan.org',\n      apiUrl: 'https://api.basescan.org/api',\n    },\n  },\n  contracts: {\n    ...chainConfig.contracts,\n    disputeGameFactory: {\n      [sourceId]: {\n        address: '0x43edB88C4B80fDD2AdFF2412A7BebF9dF42cB40e',\n      },\n    },\n    l2OutputOracle: {\n      [sourceId]: {\n        address: '0x56315b90c40730925ec5485cf004d835058518A0',\n      },\n    },\n    multicall3: {\n      address: '0xca11bde05977b3631167028862be2a173976ca11',\n      blockCreated: 5022,\n    },\n    portal: {\n      [sourceId]: {\n        address: '0x49048044D57e1C92A77f79988d21Fa8fAF74E97e',\n        blockCreated: 17482143,\n      },\n    },\n    l1StandardBridge: {\n      [sourceId]: {\n        address: '0x3154Cf16ccdb4C6d922629664174b904d80F2C35',\n        blockCreated: 17482143,\n      },\n    },\n  },\n  sourceId,\n})\n\nexport const basePreconf = /*#__PURE__*/ defineChain({\n  ...base,\n  experimental_preconfirmationTime: 200,\n  rpcUrls: {\n    default: {\n      http: ['https://mainnet-preconf.base.org'],\n    },\n  },\n})\n","import { contracts } from './contracts.js'\nimport { formatters } from './formatters.js'\nimport { serializers } from './serializers.js'\n\nexport const chainConfig = {\n  blockTime: 2_000,\n  contracts,\n  formatters,\n  serializers,\n} as const\n","import { InvalidAddressError } from '../errors/address.js'\nimport type { ErrorType } from '../errors/utils.js'\nimport type { ChainSerializers } from '../types/chain.js'\nimport type { Hex, Signature } from '../types/misc.js'\nimport type { TransactionSerializable } from '../types/transaction.js'\nimport type { RequiredBy } from '../types/utils.js'\nimport { isAddress } from '../utils/address/isAddress.js'\nimport { concatHex } from '../utils/data/concat.js'\nimport { toHex } from '../utils/encoding/toHex.js'\nimport { toRlp } from '../utils/encoding/toRlp.js'\nimport {\n  type SerializeTransactionErrorType as SerializeTransactionErrorType_,\n  serializeTransaction as serializeTransaction_,\n} from '../utils/transaction/serializeTransaction.js'\nimport type {\n  OpStackTransactionSerializable,\n  TransactionSerializableDeposit,\n  TransactionSerializedDeposit,\n} from './types/transaction.js'\n\nexport type SerializeTransactionReturnType = ReturnType<\n  typeof serializeTransaction\n>\n\nexport type SerializeTransactionErrorType =\n  | SerializeTransactionErrorType_\n  | ErrorType\n\nexport function serializeTransaction(\n  transaction: OpStackTransactionSerializable,\n  signature?: Signature,\n) {\n  if (isDeposit(transaction)) return serializeTransactionDeposit(transaction)\n  return serializeTransaction_(\n    transaction as TransactionSerializable,\n    signature,\n  )\n}\n\nexport const serializers = {\n  transaction: serializeTransaction,\n} as const satisfies ChainSerializers\n\n//////////////////////////////////////////////////////////////////////////////\n// Serializers\n\nexport type SerializeTransactionDepositReturnType = TransactionSerializedDeposit\n\nfunction serializeTransactionDeposit(\n  transaction: TransactionSerializableDeposit,\n): SerializeTransactionDepositReturnType {\n  assertTransactionDeposit(transaction)\n\n  const { sourceHash, data, from, gas, isSystemTx, mint, to, value } =\n    transaction\n\n  const serializedTransaction: Hex[] = [\n    sourceHash,\n    from,\n    to ?? '0x',\n    mint ? toHex(mint) : '0x',\n    value ? toHex(value) : '0x',\n    gas ? toHex(gas) : '0x',\n    isSystemTx ? '0x1' : '0x',\n    data ?? '0x',\n  ]\n\n  return concatHex([\n    '0x7e',\n    toRlp(serializedTransaction),\n  ]) as SerializeTransactionDepositReturnType\n}\n\nfunction isDeposit(\n  transaction: OpStackTransactionSerializable,\n): transaction is RequiredBy<TransactionSerializableDeposit, 'type'> {\n  if (transaction.type === 'deposit') return true\n  if (typeof transaction.sourceHash !== 'undefined') return true\n  return false\n}\n\nexport function assertTransactionDeposit(\n  transaction: TransactionSerializableDeposit,\n) {\n  const { from, to } = transaction\n  if (from && !isAddress(from)) throw new InvalidAddressError({ address: from })\n  if (to && !isAddress(to)) throw new InvalidAddressError({ address: to })\n}\n","import type { ChainFormatters } from '../types/chain.js'\nimport type { RpcTransaction } from '../types/rpc.js'\nimport { hexToBigInt } from '../utils/encoding/fromHex.js'\nimport { defineBlock } from '../utils/formatters/block.js'\nimport {\n  defineTransaction,\n  formatTransaction,\n} from '../utils/formatters/transaction.js'\nimport { defineTransactionReceipt } from '../utils/formatters/transactionReceipt.js'\nimport type { OpStackBlock, OpStackRpcBlock } from './types/block.js'\nimport type {\n  OpStackRpcTransaction,\n  OpStackRpcTransactionReceipt,\n  OpStackTransaction,\n  OpStackTransactionReceipt,\n} from './types/transaction.js'\n\nexport const formatters = {\n  block: /*#__PURE__*/ defineBlock({\n    format(args: OpStackRpcBlock): OpStackBlock {\n      const transactions = args.transactions?.map((transaction) => {\n        if (typeof transaction === 'string') return transaction\n        const formatted = formatTransaction(\n          transaction as RpcTransaction,\n        ) as OpStackTransaction\n        if (formatted.typeHex === '0x7e') {\n          formatted.isSystemTx = transaction.isSystemTx\n          formatted.mint = transaction.mint\n            ? hexToBigInt(transaction.mint)\n            : undefined\n          formatted.sourceHash = transaction.sourceHash\n          formatted.type = 'deposit'\n        }\n        return formatted\n      })\n      return {\n        transactions,\n        stateRoot: args.stateRoot,\n      } as OpStackBlock\n    },\n  }),\n  transaction: /*#__PURE__*/ defineTransaction({\n    format(args: OpStackRpcTransaction): OpStackTransaction {\n      const transaction = {} as OpStackTransaction\n      if (args.type === '0x7e') {\n        transaction.isSystemTx = args.isSystemTx\n        transaction.mint = args.mint ? hexToBigInt(args.mint) : undefined\n        transaction.sourceHash = args.sourceHash\n        transaction.type = 'deposit'\n      }\n      return transaction\n    },\n  }),\n  transactionReceipt: /*#__PURE__*/ defineTransactionReceipt({\n    format(args: OpStackRpcTransactionReceipt): OpStackTransactionReceipt {\n      return {\n        l1GasPrice: args.l1GasPrice ? hexToBigInt(args.l1GasPrice) : null,\n        l1GasUsed: args.l1GasUsed ? hexToBigInt(args.l1GasUsed) : null,\n        l1Fee: args.l1Fee ? hexToBigInt(args.l1Fee) : null,\n        l1FeeScalar: args.l1FeeScalar ? Number(args.l1FeeScalar) : null,\n      } as OpStackTransactionReceipt\n    },\n  }),\n} as const satisfies ChainFormatters\n","import type { Chain } from '../types/chain.js'\n\n/**\n * Predeploy contracts for OP Stack.\n * @see https://github.com/ethereum-optimism/optimism/blob/develop/specs/predeploys.md\n */\nexport const contracts = {\n  gasPriceOracle: { address: '0x420000000000000000000000000000000000000F' },\n  l1Block: { address: '0x4200000000000000000000000000000000000015' },\n  l2CrossDomainMessenger: {\n    address: '0x4200000000000000000000000000000000000007',\n  },\n  l2Erc721Bridge: { address: '0x4200000000000000000000000000000000000014' },\n  l2StandardBridge: { address: '0x4200000000000000000000000000000000000010' },\n  l2ToL1MessagePasser: {\n    address: '0x4200000000000000000000000000000000000016',\n  },\n} as const satisfies Chain['contracts']\n"],"names":[],"mappings":"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E,ADAA,EFHI,CEGC,CDJU,CAAA,ACIR,CFHC,CAAiB,CGGC,CHHf,EEGE,EDJE,CEIiB,IAAA,WAAA,AHHI,EAAC,CAC5C,EGWI,ACXA,CFE4C,AFF7C,CEE6C,AFFlC,CEGP,AFFP,CCFgB,CDEd,CIDkB,AFGA,AACf,AFHD,CGUiB,AAChB,ADNL,SFJM,CIAC,MJCP,YGDkF,CAAA,EHClE,CAAE,IAAI,AIAA,CJAE,CEuBC,CAAC,ACZJ,MHXW,OAAQ,MAAO,GGWD,MHXW,EAAE,CAAE,CAC9D,CGU4D,EAAE,EAAE,GHVvD,CACP,QAAS,CACP,KAAA,CAAO,2BAA2B,GAGtC,eAAgB,CACd,QAAS,AGWM,CHVb,IAAI,CAAE,CGWA,CAAC,IACD,CAAC,IHXP,GAAG,CAAE,uBACL,MAAM,CAAA,gCAET,CACD,UAAW,CACT,EEoCU,CFpCP,EAAY,EEqCE,CAAC,CAAC,CAAC,IFrCI,CEqCC,AFpCzB,KEqCK,CAAC,CAAC,YFrCa,CEqCC,CAAC,CFpCR,CGYD,ADyBI,AFpCb,CEoCc,CACR,CAAC,CAAC,IFrCC,CEqCK,CAAC,CAAC,4CFlCpB,eAAgB,GACF,CACV,QAAS,IGYM,2CHTnB,WAAY,CACV,MGWa,EHXJ,6CACT,aAAc,CGYD,YHVP,GACM,CACV,OAAO,CAAE,4CAA4C,CACrD,MGYY,OHZE,YAGlB,iBAAkB,GACJ,CACV,QAAS,EGYE,2CHXX,WGYW,CHZC,CAAE,GGYG,UHRvB,QAAQ,CAhDO,CEIC,AFJA,CAAA,AAiDjB,CAjDkB,AAiDjB,CAAA,CClDoB,IEGH,ADEO,ECDxB,AFJ0B,EDCC,eGGV,CFJ2B,CAAA,CEK7C,GDAkD,CAAA,ECA5C,oCAAoC,CAAA","ignoreList":[1,2,3,4,5]}