module.exports=[14747,(e,t,r)=>{t.exports=e.x("path",()=>require("path"))},70406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},24361,(e,t,r)=>{t.exports=e.x("util",()=>require("util"))},93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},22734,(e,t,r)=>{t.exports=e.x("fs",()=>require("fs"))},87769,(e,t,r)=>{t.exports=e.x("node:events",()=>require("node:events"))},874,(e,t,r)=>{t.exports=e.x("buffer",()=>require("buffer"))},27699,(e,t,r)=>{t.exports=e.x("events",()=>require("events"))},92509,(e,t,r)=>{t.exports=e.x("url",()=>require("url"))},49719,(e,t,r)=>{t.exports=e.x("assert",()=>require("assert"))},62562,(e,t,r)=>{t.exports=e.x("module",()=>require("module"))},50227,(e,t,r)=>{t.exports=e.x("node:path",()=>require("node:path"))},94346,e=>{e.v({name:"thread-stream",version:"3.1.0",description:"A streaming way to send data to a Node.js Worker Thread",main:"index.js",types:"index.d.ts",dependencies:{"real-require":"^0.2.0"},devDependencies:{"@types/node":"^20.1.0","@types/tap":"^15.0.0","@yao-pkg/pkg":"^5.11.5",desm:"^1.3.0",fastbench:"^1.0.1",husky:"^9.0.6","pino-elasticsearch":"^8.0.0","sonic-boom":"^4.0.1",standard:"^17.0.0",tap:"^16.2.0","ts-node":"^10.8.0",typescript:"^5.3.2","why-is-node-running":"^2.2.2"},scripts:{build:"tsc --noEmit",test:'standard && npm run build && npm run transpile && tap "test/**/*.test.*js" && tap --ts test/*.test.*ts',"test:ci":"standard && npm run transpile && npm run test:ci:js && npm run test:ci:ts","test:ci:js":'tap --no-check-coverage --timeout=120 --coverage-report=lcovonly "test/**/*.test.*js"',"test:ci:ts":'tap --ts --no-check-coverage --coverage-report=lcovonly "test/**/*.test.*ts"',"test:yarn":'npm run transpile && tap "test/**/*.test.js" --no-check-coverage',transpile:"sh ./test/ts/transpile.sh",prepare:"husky install"},standard:{ignore:["test/ts/**/*","test/syntax-error.mjs"]},repository:{type:"git",url:"git+https://github.com/mcollina/thread-stream.git"},keywords:["worker","thread","threads","stream"],author:"Matteo Collina <hello@matteocollina.com>",license:"MIT",bugs:{url:"https://github.com/mcollina/thread-stream/issues"},homepage:"https://github.com/mcollina/thread-stream#readme"})},37702,(e,t,r)=>{t.exports=e.x("worker_threads",()=>require("worker_threads"))},60526,(e,t,r)=>{t.exports=e.x("node:os",()=>require("node:os"))},77652,(e,t,r)=>{t.exports=e.x("node:diagnostics_channel",()=>require("node:diagnostics_channel"))},62604,e=>{"use strict";var t=e.i(66680);let r=t.default.webcrypto?.subtle||{},a=e=>t.default.webcrypto.getRandomValues(e);e.s(["getRandomValues",()=>a,"subtle",()=>r])},87545,46747,e=>{"use strict";var t=e.i(28066),r=e.i(20230),a=e.i(2409),s=e.i(17081);async function n(e){let{domain:t,message:r,primaryType:n,signature:i,types:o}=e;return(0,s.recoverAddress)({hash:(0,a.hashTypedData)({domain:t,message:r,primaryType:n,types:o}),signature:i})}async function i(e){let{address:a,domain:s,message:i,primaryType:o,signature:l,types:c}=e;return(0,r.isAddressEqual)((0,t.getAddress)(a),await n({domain:s,message:i,primaryType:o,signature:l,types:c}))}e.s(["recoverTypedDataAddress",()=>n],46747),e.s(["verifyTypedData",()=>i],87545)},34597,e=>{"use strict";let t,r,a,s;var n=e.i(56036);let i=(0,e.i(50377).createLogger)({component:"X402ResourceServer"});async function o(){if(!t)try{let n=await e.A(83788),i=await e.A(76810),o=await e.A(76900),l=await e.A(80831);t=n.x402ResourceServer,r=i.HTTPFacilitatorClient,a=o.bazaarResourceServerExtension,s=l.registerExactEvmScheme}catch(e){throw i.warn({error:e},"x402 packages not available - discovery features will be limited"),Error("x402 packages not installed")}return{x402ResourceServer:t,HTTPFacilitatorClient:r,bazaarResourceServerExtension:a,registerExactEvmScheme:s}}class l{cdpFacilitator;baseClient;constructor(){this.cdpFacilitator=(0,n.getCDPFacilitator)()}async initialize(e){this.baseClient=new e({url:process.env.CDP_FACILITATOR_URL||"https://api.cdp.coinbase.com/platform/v2/x402"}),Object.setPrototypeOf(this,this.baseClient.constructor.prototype)}async verify(e,t,r){try{let a=await this.cdpFacilitator.verifyPaymentWithRetry({payment:e,paymentPayload:t,paymentRequirements:r});if(a.success&&a.valid)return{isValid:!0,transactionHash:a.transactionHash,kytStatus:a.kytStatus,ofacStatus:a.ofacStatus};return{isValid:!1,invalidReason:a.error,errorMessage:a.error}}catch(e){return i.error({error:e},"CDP facilitator verification error"),{isValid:!1,invalidReason:e instanceof Error?e.message:"Verification failed"}}}}let c=null;async function p(){try{let{x402ResourceServer:t,HTTPFacilitatorClient:r,bazaarResourceServerExtension:a,registerExactEvmScheme:s}=await o();if(!c){let n=new l;await n.initialize(r),c=new t(n),s(c),c.registerExtension(a),e.A(33218).then(({getChainRegistry:e})=>{let t=e().getEVMs();i.info({supportedNetworks:t.map(e=>({caip:e.caip,name:e.name,chainId:e.chainId}))},"x402 Resource Server initialized with Bazaar extension and multi-chain support")}).catch(()=>{i.info("x402 Resource Server initialized with Bazaar extension")})}return c}catch(e){return i.warn({error:e},"x402 resource server not available - discovery endpoint may not function"),null}}e.s(["getX402ResourceServer",()=>p])},81784,e=>{"use strict";function t(e){try{let t,[r,a]=e.split(":");if(!r||!a||"eip155"===r&&(t=parseInt(a,10),isNaN(t)))return null;return{namespace:r,reference:a,chainId:t}}catch{return null}}function r(e){try{let r=e.split("/");if(2!==r.length)return null;let a=r[0],s=r[1],n=t(a);if(!n)return null;let[i,o]=s.split(":");if(!i||!o)return null;return{network:n,assetNamespace:i,assetReference:o,address:"erc20"===i?o:void 0}}catch{return null}}function a(e){return({ethereum:"eip155:1",mainnet:"eip155:1",base:"eip155:8453","base-mainnet":"eip155:8453",bnb:"eip155:56","bnb-chain":"eip155:56",bsc:"eip155:56",polygon:"eip155:137","polygon-mainnet":"eip155:137",arbitrum:"eip155:42161","arbitrum-one":"eip155:42161",optimism:"eip155:10","optimism-mainnet":"eip155:10",avalanche:"eip155:43114","avalanche-mainnet":"eip155:43114",solana:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","solana-mainnet":"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",cronos:"eip155:25","cronos-mainnet":"eip155:25","cronos-testnet":"eip155:338"})[e.toLowerCase().replace(/_/g,"-")]||null}function s(e){return null!==t(e)}function n(e){return null!==r(e)}function i(e,t){let r=a(e);return r?`${r}/erc20:${t}`:null}e.s(["CAIP_ASSETS",0,{USDC_ETHEREUM:"eip155:1/erc20:0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48",USDC_BASE:"eip155:8453/erc20:0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913",USDC_POLYGON:"eip155:137/erc20:0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174",USDC_ARBITRUM:"eip155:42161/erc20:0xaf88d065e77c8cC2239327C5EDb3A432268e5831",USDC_OPTIMISM:"eip155:10/erc20:0x0b2C639c533813f4Aa9D7837CAf62653d097Ff85",ETH_ETHEREUM:"eip155:1/slip44:60"},"CAIP_NETWORKS",0,{ETHEREUM:"eip155:1",BASE:"eip155:8453",BNB_CHAIN:"eip155:56",POLYGON:"eip155:137",ARBITRUM:"eip155:42161",OPTIMISM:"eip155:10",AVALANCHE:"eip155:43114",SOLANA:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",CRONOS:"eip155:25",CRONOS_TESTNET:"eip155:338"},"networkToCAIP",()=>a,"parseCAIPAsset",()=>r,"parseCAIPNetwork",()=>t,"tokenToCAIP",()=>i,"validateCAIPAsset",()=>n,"validateCAIPNetwork",()=>s])},98696,e=>{"use strict";var t=e.i(81784);class r{networks=new Map;constructor(){this.registerDefaultNetworks()}register(e){this.networks.set(e.caip,e)}get(e){return this.networks.get(e)}getByLegacyName(e){for(let t of this.networks.values())if(t.name.toLowerCase()===e.toLowerCase())return t}getAll(){return Array.from(this.networks.values())}getEVMs(){return Array.from(this.networks.values()).filter(e=>e.isEVM)}getSolanas(){return Array.from(this.networks.values()).filter(e=>e.isSolana)}has(e){return this.networks.has(e)}registerDefaultNetworks(){this.register({caip:t.CAIP_NETWORKS.ETHEREUM,name:"ethereum",displayName:"Ethereum",chainId:1,nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:["https://eth.llamarpc.com"],blockExplorers:[{name:"Etherscan",url:"https://etherscan.io"}],isTestnet:!1,isEVM:!0,isSolana:!1,supportsEIP1559:!0,averageGasPrice:"30000000000",averageBlockTime:12}),this.register({caip:t.CAIP_NETWORKS.BASE,name:"base",displayName:"Base",chainId:8453,nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:["https://mainnet.base.org"],blockExplorers:[{name:"BaseScan",url:"https://basescan.org"}],isTestnet:!1,isEVM:!0,isSolana:!1,supportsEIP1559:!0,averageGasPrice:"1000000",averageBlockTime:2}),this.register({caip:t.CAIP_NETWORKS.BNB_CHAIN,name:"bnb",displayName:"BNB Chain",chainId:56,nativeCurrency:{name:"BNB",symbol:"BNB",decimals:18},rpcUrls:["https://bsc-dataseed.binance.org"],blockExplorers:[{name:"BscScan",url:"https://bscscan.com"}],isTestnet:!1,isEVM:!0,isSolana:!1,supportsEIP1559:!1,averageGasPrice:"3000000000",averageBlockTime:3}),this.register({caip:t.CAIP_NETWORKS.POLYGON,name:"polygon",displayName:"Polygon",chainId:137,nativeCurrency:{name:"MATIC",symbol:"MATIC",decimals:18},rpcUrls:["https://polygon-rpc.com"],blockExplorers:[{name:"PolygonScan",url:"https://polygonscan.com"}],isTestnet:!1,isEVM:!0,isSolana:!1,supportsEIP1559:!0,averageGasPrice:"30000000000",averageBlockTime:2}),this.register({caip:t.CAIP_NETWORKS.ARBITRUM,name:"arbitrum",displayName:"Arbitrum One",chainId:42161,nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:["https://arb1.arbitrum.io/rpc"],blockExplorers:[{name:"Arbiscan",url:"https://arbiscan.io"}],isTestnet:!1,isEVM:!0,isSolana:!1,supportsEIP1559:!0,averageGasPrice:"100000000",averageBlockTime:.25}),this.register({caip:t.CAIP_NETWORKS.OPTIMISM,name:"optimism",displayName:"Optimism",chainId:10,nativeCurrency:{name:"Ether",symbol:"ETH",decimals:18},rpcUrls:["https://mainnet.optimism.io"],blockExplorers:[{name:"Optimistic Etherscan",url:"https://optimistic.etherscan.io"}],isTestnet:!1,isEVM:!0,isSolana:!1,supportsEIP1559:!0,averageGasPrice:"1000000",averageBlockTime:2}),this.register({caip:t.CAIP_NETWORKS.AVALANCHE,name:"avalanche",displayName:"Avalanche",chainId:43114,nativeCurrency:{name:"AVAX",symbol:"AVAX",decimals:18},rpcUrls:["https://api.avax.network/ext/bc/C/rpc"],blockExplorers:[{name:"Snowtrace",url:"https://snowtrace.io"}],isTestnet:!1,isEVM:!0,isSolana:!1,supportsEIP1559:!0,averageGasPrice:"25000000000",averageBlockTime:2}),this.register({caip:t.CAIP_NETWORKS.SOLANA,name:"solana",displayName:"Solana",chainId:null,nativeCurrency:{name:"SOL",symbol:"SOL",decimals:9},rpcUrls:["https://api.mainnet-beta.solana.com"],blockExplorers:[{name:"Solana Explorer",url:"https://explorer.solana.com"}],isTestnet:!1,isEVM:!1,isSolana:!0,averageBlockTime:.4}),this.register({caip:t.CAIP_NETWORKS.CRONOS,name:"cronos",displayName:"Cronos",chainId:25,nativeCurrency:{name:"CRO",symbol:"CRO",decimals:18},rpcUrls:["https://evm.cronos.org"],blockExplorers:[{name:"Cronoscan",url:"https://cronoscan.com"}],isTestnet:!1,isEVM:!0,isSolana:!1,supportsEIP1559:!0,averageGasPrice:"5000000000000",averageBlockTime:6}),this.register({caip:t.CAIP_NETWORKS.CRONOS_TESTNET,name:"cronos-testnet",displayName:"Cronos Testnet",chainId:338,nativeCurrency:{name:"Test CRO",symbol:"TCRO",decimals:18},rpcUrls:["https://evm-t3.cronos.org"],blockExplorers:[{name:"Cronos Testnet Explorer",url:"https://testnet.cronoscan.com"}],isTestnet:!0,isEVM:!0,isSolana:!1,supportsEIP1559:!0,averageGasPrice:"5000000000000",averageBlockTime:6})}}let a=null;function s(){return a||(a=new r),a}e.s(["ChainRegistry",()=>r,"getChainRegistry",()=>s])},32936,e=>{"use strict";var t=e.i(47909),r=e.i(74017),a=e.i(96250),s=e.i(59756),n=e.i(61916),i=e.i(14444),o=e.i(37092),l=e.i(69741),c=e.i(16795),p=e.i(87718),u=e.i(95169),d=e.i(47587),m=e.i(66012),h=e.i(70101),v=e.i(26937),E=e.i(10372),x=e.i(93695);e.i(52474);var y=e.i(220),g=e.i(89171),_=e.i(34597),f=e.i(81784),C=e.i(98696);async function S(t){try{await (0,_.getX402ResourceServer)()}catch(e){}let r=t.headers.get("x-payment")||t.headers.get("X-Payment");if(!r){let e=(0,C.getChainRegistry)(),r={scheme:"exact",networks:[f.CAIP_NETWORKS.BASE,f.CAIP_NETWORKS.POLYGON,f.CAIP_NETWORKS.ARBITRUM],assets:[f.CAIP_ASSETS.USDC_BASE,f.CAIP_ASSETS.USDC_POLYGON,f.CAIP_ASSETS.USDC_ARBITRUM],amount:"1000000",recipient:process.env.X402_RECIPIENT_ADDRESS||"0x0000000000000000000000000000000000000000",description:"Hello World Test Endpoint",resource:new URL(t.url).toString()},a=r.networks.map(t=>{let r=e.get(t);return{caip:t,name:r?.name||"unknown",chainId:r?.chainId||null,displayName:r?.displayName||"Unknown",nativeCurrency:r?.nativeCurrency,rpcUrls:r?.rpcUrls||[],blockExplorers:r?.blockExplorers||[]}});return g.NextResponse.json({error:"Payment Required",code:"PAYMENT_REQUIRED",message:"This endpoint requires x402 payment verification",paymentDetails:{...r,networks:a,legacy:{network:"base",chainId:8453,token:"0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913",tokenSymbol:"USDC"}},instructions:{step1:"Parse paymentDetails to see available networks and assets",step2:"Select a network/asset combination (e.g., Base + USDC)",step3:"Create an x402 payment authorization for the selected network",step4:"Include payment in x-payment header and retry request",step5:"Receive 200 OK with greeting after verification"},x402Version:"2.0",bazaarCompatible:!0},{status:402,headers:{"Content-Type":"application/json","X-x402-Version":"2.0","X-x402-Scheme":"exact"}})}try{let{parseAndVerifyPaymentHeader:t}=await e.A(5371),{getMetaFacilitator:a}=await e.A(86684);await e.A(37049);let s=await t(r);if(!s.valid||!s.payment)return g.NextResponse.json({error:"Invalid payment",code:"INVALID_PAYMENT",details:s.error},{status:400});let n={scheme:"exact",network:s.payment.network||"base",networks:[f.CAIP_NETWORKS.BASE],maxAmountRequired:"1000000",resource:"https://nexflowapp.app/api/test/hello-world",description:"Hello World Test Endpoint",mimeType:"application/json",payTo:process.env.X402_RECIPIENT_ADDRESS||"0x0000000000000000000000000000000000000000",maxTimeoutSeconds:300,asset:"0x833589fCD6eDb6E08f4c7C32D4f71b54bdA02913",assets:[f.CAIP_ASSETS.USDC_BASE]},i=a(),o=await i.verifyPayment(r,n,{requireCompliance:!0},{requireHealthCheck:!0});if(!o.valid||!o.success)return g.NextResponse.json({error:"Payment verification failed",code:"VERIFICATION_FAILED",details:o.error,kytStatus:o.kytStatus,ofacStatus:o.ofacStatus},{status:400});if("blocked"===o.kytStatus||"blocked"===o.ofacStatus)return g.NextResponse.json({error:"Payment blocked by compliance check",code:"COMPLIANCE_BLOCKED",kytStatus:o.kytStatus,ofacStatus:o.ofacStatus},{status:403});return g.NextResponse.json({success:!0,message:"Hello, World!",greeting:"Welcome to NexFlow x402 Payment Infrastructure",payment:{verified:!0,transactionHash:o.transactionHash,facilitator:o.facilitatorUsed,network:s.payment.network,amount:s.payment.authorization.value,kytStatus:o.kytStatus,ofacStatus:o.ofacStatus},timestamp:new Date().toISOString()},{status:200,headers:{"X-x402-Verified":"true","X-x402-TxHash":o.transactionHash||"","X-x402-Facilitator":o.facilitatorUsed||"cdp"}})}catch(e){return g.NextResponse.json({error:"Internal server error",code:"INTERNAL_ERROR",details:e instanceof Error?e.message:"Unknown error"},{status:500})}}e.s(["GET",()=>S],69540);var R=e.i(69540);let b=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/test/hello-world/route",pathname:"/api/test/hello-world",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/test/hello-world/route.ts",nextConfigOutput:"standalone",userland:R}),{workAsyncStorage:A,workUnitAsyncStorage:T,serverHooks:k}=b;function w(){return(0,a.patchFetch)({workAsyncStorage:A,workUnitAsyncStorage:T})}async function P(e,t,a){b.isDev&&(0,s.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let g="/api/test/hello-world/route";g=g.replace(/\/index$/,"")||"/";let _=await b.prepare(e,t,{srcPage:g,multiZoneDraftMode:!1});if(!_)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:f,params:C,nextConfig:S,parsedUrl:R,isDraftMode:A,prerenderManifest:T,routerServerContext:k,isOnDemandRevalidate:w,revalidateOnlyGenerated:P,resolvedPathname:I,clientReferenceManifest:N,serverActionsManifest:O}=_,U=(0,l.normalizeAppPath)(g),D=!!(T.dynamicRoutes[U]||T.routes[I]),j=async()=>((null==k?void 0:k.render404)?await k.render404(e,t,R,!1):t.end("This page could not be found"),null);if(D&&!A){let e=!!T.routes[I],t=T.dynamicRoutes[U];if(t&&!1===t.fallback&&!e){if(S.experimental.adapterPath)return await j();throw new x.NoFallbackError}}let M=null;!D||b.isDev||A||(M="/index"===(M=I)?"/":M);let q=!0===b.isDev||!D,B=D&&!q;O&&N&&(0,i.setReferenceManifestsSingleton)({page:g,clientReferenceManifest:N,serverActionsManifest:O,serverModuleMap:(0,o.createServerModuleMap)({serverActionsManifest:O})});let H=e.method||"GET",K=(0,n.getTracer)(),V=K.getActiveScopeSpan(),L={params:C,prerenderManifest:T,renderOpts:{experimental:{authInterrupts:!!S.experimental.authInterrupts},cacheComponents:!!S.cacheComponents,supportsDynamicResponse:q,incrementalCache:(0,s.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:S.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a)=>b.onRequestError(e,t,a,k)},sharedContext:{buildId:f}},F=new c.NodeNextRequest(e),W=new c.NodeNextResponse(t),X=p.NextRequestAdapter.fromNodeNextRequest(F,(0,p.signalFromNodeResponse)(t));try{let i=async e=>b.handle(X,L).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=K.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${H} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${H} ${g}`)}),o=!!(0,s.getRequestMeta)(e,"minimalMode"),l=async s=>{var n,l;let c=async({previousCacheEntry:r})=>{try{if(!o&&w&&P&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let n=await i(s);e.fetchMetrics=L.renderOpts.fetchMetrics;let l=L.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let c=L.renderOpts.collectedTags;if(!D)return await (0,m.sendResponse)(F,W,n,L.renderOpts.pendingWaitUntil),null;{let e=await n.blob(),t=(0,h.toNodeOutgoingHttpHeaders)(n.headers);c&&(t[E.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==L.renderOpts.collectedRevalidate&&!(L.renderOpts.collectedRevalidate>=E.INFINITE_CACHE)&&L.renderOpts.collectedRevalidate,a=void 0===L.renderOpts.collectedExpire||L.renderOpts.collectedExpire>=E.INFINITE_CACHE?void 0:L.renderOpts.collectedExpire;return{value:{kind:y.CachedRouteKind.APP_ROUTE,status:n.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await b.onRequestError(e,t,{routerKind:"App Router",routePath:g,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:B,isOnDemandRevalidate:w})},k),t}},p=await b.handleResponse({req:e,nextConfig:S,cacheKey:M,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:T,isRoutePPREnabled:!1,isOnDemandRevalidate:w,revalidateOnlyGenerated:P,responseGenerator:c,waitUntil:a.waitUntil,isMinimalMode:o});if(!D)return null;if((null==p||null==(n=p.value)?void 0:n.kind)!==y.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==p||null==(l=p.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||t.setHeader("x-nextjs-cache",w?"REVALIDATED":p.isMiss?"MISS":p.isStale?"STALE":"HIT"),A&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let u=(0,h.fromNodeOutgoingHttpHeaders)(p.value.headers);return o&&D||u.delete(E.NEXT_CACHE_TAGS_HEADER),!p.cacheControl||t.getHeader("Cache-Control")||u.get("Cache-Control")||u.set("Cache-Control",(0,v.getCacheControlHeader)(p.cacheControl)),await (0,m.sendResponse)(F,W,new Response(p.value.body,{headers:u,status:p.value.status||200})),null};V?await l(V):await K.withPropagatedContext(e.headers,()=>K.trace(u.BaseServerSpan.handleRequest,{spanName:`${H} ${g}`,kind:n.SpanKind.SERVER,attributes:{"http.method":H,"http.target":e.url}},l))}catch(t){if(t instanceof x.NoFallbackError||await b.onRequestError(e,t,{routerKind:"App Router",routePath:U,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:B,isOnDemandRevalidate:w})}),D)throw t;return await (0,m.sendResponse)(F,W,new Response(null,{status:500})),null}}e.s(["handler",()=>P,"patchFetch",()=>w,"routeModule",()=>b,"serverHooks",()=>k,"workAsyncStorage",()=>A,"workUnitAsyncStorage",()=>T],32936)},455,e=>{e.v(t=>Promise.all(["server/chunks/node_modules_bc74a3ae._.js"].map(t=>e.l(t))).then(()=>t(1805)))},5371,e=>{e.v(t=>Promise.all(["server/chunks/src_integrations_x402_payment-header-parser_ts_db7a382b._.js"].map(t=>e.l(t))).then(()=>t(71556)))},83788,e=>{e.v(t=>Promise.all(["server/chunks/node_modules_@x402_core_dist_esm_server_index_mjs_fb9fdec2._.js","server/chunks/node_modules_@x402_core_dist_esm_chunk-XT4E3FX4_mjs_48e49267._.js"].map(t=>e.l(t))).then(()=>t(81315)))},76810,e=>{e.v(t=>Promise.all(["server/chunks/node_modules_@x402_core_dist_esm_http_index_mjs_a9c19016._.js","server/chunks/node_modules_@x402_core_dist_esm_chunk-XT4E3FX4_mjs_48e49267._.js"].map(t=>e.l(t))).then(()=>t(63027)))},76900,e=>{e.v(t=>Promise.all(["server/chunks/node_modules_688c3c10._.js"].map(t=>e.l(t))).then(()=>t(43614)))},80831,e=>{e.v(t=>Promise.all(["server/chunks/node_modules_@x402_evm_dist_esm_exact_server_index_mjs_58cd597c._.js"].map(t=>e.l(t))).then(()=>t(46917)))},33218,e=>{e.v(e=>Promise.resolve().then(()=>e(98696)))},86684,e=>{e.v(t=>Promise.all(["server/chunks/[root-of-the-server]__3e9facb3._.js","server/chunks/src_services_b76bdbea._.js","server/chunks/[root-of-the-server]__e9c70ed4._.js","server/chunks/src_ab5eb711._.js","server/chunks/src_a3554d02._.js"].map(t=>e.l(t))).then(()=>t(42373)))},37049,e=>{e.v(t=>Promise.all(["server/chunks/src_integrations_x402_facilitators_base-facilitator_ts_009b0c52._.js"].map(t=>e.l(t))).then(()=>t(22444)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__48eab091._.js.map