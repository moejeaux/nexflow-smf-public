module.exports=[40252,a=>{"use strict";var b=a.i(87924),c=a.i(72131);function d(){let[a,d]=(0,c.useState)([]),[e,f]=(0,c.useState)([]),[g,h]=(0,c.useState)(!0),[i,j]=(0,c.useState)(null);async function k(){try{h(!0);let a=await fetch("/api/security/events",{headers:{Authorization:`Bearer ${localStorage.getItem("apiKey")||""}`}});if(!a.ok)throw Error(`Failed to load security events: ${a.status}`);let b=await a.json();d(b.threatHistory||[]),f(b.blockedIps||[]),j(null)}catch(a){j(a instanceof Error?a.message:"Failed to load security events")}finally{h(!1)}}(0,c.useEffect)(()=>{k();let a=setInterval(k,3e4);return()=>clearInterval(a)},[]);let l={critical:"bg-red-600",high:"bg-orange-600",medium:"bg-yellow-600",low:"bg-blue-600"};return(0,b.jsx)("div",{className:"min-h-screen bg-gray-900 text-white p-8",children:(0,b.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold mb-8",children:"Security Dashboard"}),i&&(0,b.jsx)("div",{className:"bg-red-900/50 border border-red-600 rounded-lg p-4 mb-6",children:(0,b.jsxs)("p",{className:"text-red-200",children:["Error: ",i]})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,b.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Blocked IPs"}),(0,b.jsx)("p",{className:"text-3xl font-bold text-red-400",children:e.length})]}),(0,b.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Threat Sources"}),(0,b.jsx)("p",{className:"text-3xl font-bold text-orange-400",children:a.length})]}),(0,b.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Total Threats"}),(0,b.jsx)("p",{className:"text-3xl font-bold text-yellow-400",children:a.reduce((a,b)=>a+b.threatCount,0)})]})]}),e.length>0&&(0,b.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6 mb-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Blocked IP Addresses"}),(0,b.jsx)("div",{className:"space-y-2",children:e.map(a=>(0,b.jsx)("div",{className:"bg-red-900/30 border border-red-600 rounded p-3",children:(0,b.jsx)("code",{className:"text-red-300",children:a})},a))})]}),(0,b.jsxs)("div",{className:"bg-gray-800 rounded-lg p-6",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Threat History"}),g?(0,b.jsx)("p",{className:"text-gray-400",children:"Loading..."}):0===a.length?(0,b.jsx)("p",{className:"text-gray-400",children:"No security threats detected"}):(0,b.jsx)("div",{className:"space-y-4",children:a.map(a=>(0,b.jsxs)("div",{className:"bg-gray-700 rounded-lg p-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("code",{className:"text-lg font-mono text-blue-300",children:a.ip}),(0,b.jsxs)("span",{className:"ml-4 text-sm text-gray-400",children:[a.threatCount," threat(s)"]})]}),(0,b.jsxs)("div",{className:"text-sm text-gray-400",children:["Last seen: ",new Date(a.lastSeen).toLocaleString()]})]}),(0,b.jsx)("div",{className:"mt-3 space-y-2",children:a.recentEvents.map((a,c)=>(0,b.jsxs)("div",{className:`p-2 rounded ${l[a.severity]||"bg-gray-600"}`,children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:"font-semibold",children:a.category}),(0,b.jsx)("span",{className:"ml-2 text-sm opacity-75",children:a.type})]}),(0,b.jsx)("span",{className:"text-xs uppercase",children:a.severity})]}),(0,b.jsx)("p",{className:"text-sm mt-1",children:a.description}),(0,b.jsx)("p",{className:"text-xs mt-1 opacity-75",children:new Date(a.timestamp).toLocaleString()})]},c))})]},a.ip))})]})]})})}a.s(["default",()=>d])}];

//# sourceMappingURL=src_app_dashboard_security_page_tsx_e0cef10b._.js.map