{"version":3,"sources":["../../../../src/app/dashboard/security/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useState, useEffect } from 'react';\r\nimport { apiClient } from '@/lib/api-client';\r\n\r\ninterface SecurityEvent {\r\n  ip: string;\r\n  threatCount: number;\r\n  firstSeen: string;\r\n  lastSeen: string;\r\n  recentEvents: Array<{\r\n    type: string;\r\n    severity: string;\r\n    category: string;\r\n    description: string;\r\n    timestamp: string;\r\n  }>;\r\n}\r\n\r\nexport default function SecurityDashboard() {\r\n  const [events, setEvents] = useState<SecurityEvent[]>([]);\r\n  const [blockedIps, setBlockedIps] = useState<string[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  useEffect(() => {\r\n    loadSecurityEvents();\r\n    // Refresh every 30 seconds\r\n    const interval = setInterval(loadSecurityEvents, 30000);\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  async function loadSecurityEvents() {\r\n    try {\r\n      setLoading(true);\r\n      const response = await fetch('/api/security/events', {\r\n        headers: {\r\n          'Authorization': `Bearer ${localStorage.getItem('apiKey') || ''}`,\r\n        },\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(`Failed to load security events: ${response.status}`);\r\n      }\r\n\r\n      const data = await response.json();\r\n      setEvents(data.threatHistory || []);\r\n      setBlockedIps(data.blockedIps || []);\r\n      setError(null);\r\n    } catch (err) {\r\n      setError(err instanceof Error ? err.message : 'Failed to load security events');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  const severityColors = {\r\n    critical: 'bg-red-600',\r\n    high: 'bg-orange-600',\r\n    medium: 'bg-yellow-600',\r\n    low: 'bg-blue-600',\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-900 text-white p-8\">\r\n      <div className=\"max-w-7xl mx-auto\">\r\n        <h1 className=\"text-3xl font-bold mb-8\">Security Dashboard</h1>\r\n\r\n        {error && (\r\n          <div className=\"bg-red-900/50 border border-red-600 rounded-lg p-4 mb-6\">\r\n            <p className=\"text-red-200\">Error: {error}</p>\r\n          </div>\r\n        )}\r\n\r\n        {/* Summary Cards */}\r\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8\">\r\n          <div className=\"bg-gray-800 rounded-lg p-6\">\r\n            <h2 className=\"text-lg font-semibold mb-2\">Blocked IPs</h2>\r\n            <p className=\"text-3xl font-bold text-red-400\">{blockedIps.length}</p>\r\n          </div>\r\n          <div className=\"bg-gray-800 rounded-lg p-6\">\r\n            <h2 className=\"text-lg font-semibold mb-2\">Threat Sources</h2>\r\n            <p className=\"text-3xl font-bold text-orange-400\">{events.length}</p>\r\n          </div>\r\n          <div className=\"bg-gray-800 rounded-lg p-6\">\r\n            <h2 className=\"text-lg font-semibold mb-2\">Total Threats</h2>\r\n            <p className=\"text-3xl font-bold text-yellow-400\">\r\n              {events.reduce((sum, e) => sum + e.threatCount, 0)}\r\n            </p>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Blocked IPs */}\r\n        {blockedIps.length > 0 && (\r\n          <div className=\"bg-gray-800 rounded-lg p-6 mb-6\">\r\n            <h2 className=\"text-xl font-semibold mb-4\">Blocked IP Addresses</h2>\r\n            <div className=\"space-y-2\">\r\n              {blockedIps.map((ip) => (\r\n                <div key={ip} className=\"bg-red-900/30 border border-red-600 rounded p-3\">\r\n                  <code className=\"text-red-300\">{ip}</code>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Threat History */}\r\n        <div className=\"bg-gray-800 rounded-lg p-6\">\r\n          <h2 className=\"text-xl font-semibold mb-4\">Threat History</h2>\r\n          {loading ? (\r\n            <p className=\"text-gray-400\">Loading...</p>\r\n          ) : events.length === 0 ? (\r\n            <p className=\"text-gray-400\">No security threats detected</p>\r\n          ) : (\r\n            <div className=\"space-y-4\">\r\n              {events.map((event) => (\r\n                <div key={event.ip} className=\"bg-gray-700 rounded-lg p-4\">\r\n                  <div className=\"flex items-center justify-between mb-2\">\r\n                    <div>\r\n                      <code className=\"text-lg font-mono text-blue-300\">{event.ip}</code>\r\n                      <span className=\"ml-4 text-sm text-gray-400\">\r\n                        {event.threatCount} threat(s)\r\n                      </span>\r\n                    </div>\r\n                    <div className=\"text-sm text-gray-400\">\r\n                      Last seen: {new Date(event.lastSeen).toLocaleString()}\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"mt-3 space-y-2\">\r\n                    {event.recentEvents.map((threat, idx) => (\r\n                      <div\r\n                        key={idx}\r\n                        className={`p-2 rounded ${\r\n                          severityColors[threat.severity as keyof typeof severityColors] || 'bg-gray-600'\r\n                        }`}\r\n                      >\r\n                        <div className=\"flex items-center justify-between\">\r\n                          <div>\r\n                            <span className=\"font-semibold\">{threat.category}</span>\r\n                            <span className=\"ml-2 text-sm opacity-75\">{threat.type}</span>\r\n                          </div>\r\n                          <span className=\"text-xs uppercase\">{threat.severity}</span>\r\n                        </div>\r\n                        <p className=\"text-sm mt-1\">{threat.description}</p>\r\n                        <p className=\"text-xs mt-1 opacity-75\">\r\n                          {new Date(threat.timestamp).toLocaleString()}\r\n                        </p>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              ))}\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":"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"}